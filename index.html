<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XmlEditor - Gerador Autom√°tico CT-e/MDF-e</title>
    <style>
/* ===== DESIGN SYSTEM SAAS PREMIUM ===== */
:root {
    /* Cores Premium */
    --primary: #7c3aed;
    --primary-dark: #5b21b6;
    --primary-light: #c4b5fd;
    --secondary: #059669;
    --accent: #d97706;
    --success: #10b981;
    --warning: #f59e0b;
    --danger: #dc2626;
    --info: #3b82f6;
    
    /* Escala de Cinza Profissional */
    --gray-50: #fafafa;
    --gray-100: #f4f4f5;
    --gray-200: #e4e4e7;
    --gray-300: #d4d4d8;
    --gray-400: #a1a1aa;
    --gray-500: #71717a;
    --gray-600: #52525b;
    --gray-700: #3f3f46;
    --gray-800: #27272a;
    --gray-900: #18181b;
    
    /* Gradientes Premium */
    --gradient-primary: linear-gradient(135deg, #7c3aed 0%, #5b21b6 100%);
    --gradient-secondary: linear-gradient(135deg, #059669 0%, #047857 100%);
    --gradient-accent: linear-gradient(135deg, #d97706 0%, #b45309 100%);
    --gradient-dark: linear-gradient(135deg, #18181b 0%, #27272a 100%);
    
    /* Tipografia */
    --font-sans: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    --font-heading: 'Poppins', var(--font-sans);
    --font-mono: 'JetBrains Mono', 'SF Mono', Monaco, monospace;
    
    /* Espa√ßamentos */
    --space-xs: 0.25rem;
    --space-sm: 0.5rem;
    --space-md: 1rem;
    --space-lg: 1.5rem;
    --space-xl: 2rem;
    --space-2xl: 3rem;
    
    /* Bordas */
    --radius-sm: 0.375rem;
    --radius: 0.75rem;
    --radius-lg: 1rem;
    --radius-xl: 1.5rem;
    --radius-2xl: 2rem;
    
    /* Sombras */
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-md: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    --shadow-xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    --shadow-inner: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06);
    
    /* Transi√ß√µes */
    --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
    --transition: 300ms cubic-bezier(0.4, 0, 0.2, 1);
    --transition-slow: 500ms cubic-bezier(0.4, 0, 0.2, 1);
    
    /* Z-index */
    --z-dropdown: 1000;
    --z-sticky: 1020;
    --z-fixed: 1030;
    --z-modal: 1040;
    --z-popover: 1050;
    --z-tooltip: 1060;
}

/* ===== RESET & BASE ===== */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

html {
    font-size: 16px;
    scroll-behavior: smooth;
}

body {
    font-family: var(--font-sans);
    font-size: 0.875rem;
    line-height: 1.5;
    color: var(--gray-700);
    background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
    min-height: 100vh;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

/* ===== TYPOGRAPHY ===== */
h1, h2, h3, h4, h5, h6 {
    font-family: var(--font-heading);
    font-weight: 600;
    line-height: 1.2;
    color: var(--gray-900);
}

h1 { font-size: 2.25rem; }
h2 { font-size: 1.875rem; }
h3 { font-size: 1.5rem; }
h4 { font-size: 1.25rem; }
h5 { font-size: 1.125rem; }
h6 { font-size: 1rem; }

/* ===== LAYOUT CONTAINER ===== */
.app-container {
    max-width: 100%;
    margin: 0 auto;
    display: grid;
    grid-template-columns: 280px 1fr;
    min-height: 100vh;
    background: var(--gray-50);
}

/* ===== SIDEBAR ===== */
.sidebar {
    background: var(--gradient-dark);
    color: white;
    padding: var(--space-2xl) var(--space-xl);
    display: flex;
    flex-direction: column;
    position: sticky;
    top: 0;
    height: 100vh;
    box-shadow: var(--shadow-xl);
    z-index: var(--z-fixed);
}

.logo {
    display: flex;
    align-items: center;
    gap: var(--space-md);
    margin-bottom: var(--space-2xl);
    padding-bottom: var(--space-lg);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.logo-icon {
    width: 48px;
    height: 48px;
    background: var(--gradient-primary);
    border-radius: var(--radius-lg);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    box-shadow: var(--shadow-lg);
}

.logo-text {
    font-size: 1.5rem;
    font-weight: 700;
    letter-spacing: -0.025em;
}

/* ===== NAVIGATION ===== */
.nav-section {
    margin-bottom: var(--space-2xl);
}

.nav-title {
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--gray-400);
    margin-bottom: var(--space-md);
    font-weight: 600;
}

.nav-item {
    display: flex;
    align-items: center;
    gap: var(--space-md);
    padding: var(--space-md) var(--space-lg);
    color: var(--gray-300);
    text-decoration: none;
    border-radius: var(--radius);
    transition: var(--transition);
    margin-bottom: var(--space-xs);
    font-weight: 500;
    position: relative;
    overflow: hidden;
}

.nav-item::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    height: 100%;
    width: 3px;
    background: var(--primary);
    transform: translateX(-100%);
    transition: var(--transition);
}

.nav-item:hover {
    background: rgba(255, 255, 255, 0.05);
    color: white;
}

.nav-item:hover::before {
    transform: translateX(0);
}

.nav-item.active {
    background: rgba(124, 58, 237, 0.1);
    color: white;
}

.nav-item.active::before {
    transform: translateX(0);
}

.nav-item i {
    width: 20px;
    text-align: center;
    font-size: 1.125rem;
}

/* ===== MAIN CONTENT ===== */
.main-content {
    padding: var(--space-2xl);
    overflow-y: auto;
}

/* ===== HEADER ===== */
.header {
    background: white;
    border-radius: var(--radius-xl);
    padding: var(--space-xl);
    margin-bottom: var(--space-2xl);
    box-shadow: var(--shadow-lg);
    border: 1px solid var(--gray-200);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.header-title h1 {
    font-size: 2rem;
    margin-bottom: var(--space-xs);
    background: var(--gradient-primary);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.header-title p {
    color: var(--gray-600);
    font-size: 0.875rem;
}

/* ===== STATS CARDS ===== */
.stats-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: var(--space-xl);
    margin-bottom: var(--space-2xl);
}

.stat-card {
    background: white;
    border-radius: var(--radius-xl);
    padding: var(--space-xl);
    box-shadow: var(--shadow-lg);
    border: 1px solid var(--gray-200);
    transition: var(--transition);
    position: relative;
    overflow: hidden;
}

.stat-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background: var(--gradient-primary);
}

.stat-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-xl);
}

.stat-icon {
    width: 56px;
    height: 56px;
    border-radius: var(--radius-lg);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    margin-bottom: var(--space-lg);
    color: white;
}

.stat-icon.primary { background: var(--gradient-primary); }
.stat-icon.success { background: var(--gradient-secondary); }
.stat-icon.warning { background: var(--gradient-accent); }
.stat-icon.info { background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%); }

.stat-value {
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--gray-900);
    line-height: 1;
    margin-bottom: var(--space-xs);
}

.stat-label {
    font-size: 0.875rem;
    color: var(--gray-600);
    font-weight: 500;
}

/* ===== FORM SECTION ===== */
.form-section {
    background: white;
    border-radius: var(--radius-xl);
    padding: var(--space-2xl);
    margin-bottom: var(--space-2xl);
    box-shadow: var(--shadow-lg);
    border: 1px solid var(--gray-200);
}

.section-header {
    margin-bottom: var(--space-2xl);
}

.section-title {
    font-size: 1.5rem;
    margin-bottom: var(--space-xs);
}

.section-subtitle {
    color: var(--gray-600);
    font-size: 0.875rem;
}

/* ===== FORM COMPONENTS ===== */
.form-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-xl);
    margin-bottom: var(--space-2xl);
}

.form-group {
    position: relative;
}

.form-label {
    display: block;
    font-size: 0.875rem;
    font-weight: 600;
    color: var(--gray-700);
    margin-bottom: var(--space-sm);
}

.form-label i {
    color: var(--primary);
    margin-right: var(--space-xs);
}

.form-input {
    width: 100%;
    padding: var(--space-lg);
    font-family: var(--font-sans);
    font-size: 0.875rem;
    background: var(--gray-50);
    border: 2px solid var(--gray-300);
    border-radius: var(--radius);
    transition: var(--transition);
    color: var(--gray-800);
}

.form-input:focus {
    outline: none;
    border-color: var(--primary);
    background: white;
    box-shadow: 0 0 0 3px rgba(124, 58, 237, 0.1);
}

.form-input.readonly {
    background: var(--gray-100);
    color: var(--gray-600);
    border-color: var(--gray-200);
    cursor: not-allowed;
}

.form-helper {
    font-size: 0.75rem;
    color: var(--gray-500);
    margin-top: var(--space-xs);
}

/* ===== BUTTONS ===== */
.action-buttons {
    display: flex;
    gap: var(--space-md);
    margin-top: var(--space-2xl);
}

.btn {
    padding: var(--space-lg) var(--space-xl);
    font-family: var(--font-sans);
    font-size: 0.875rem;
    font-weight: 600;
    border: none;
    border-radius: var(--radius);
    cursor: pointer;
    transition: var(--transition);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-sm);
    position: relative;
    overflow: hidden;
}

.btn::before {
    content: '';
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0;
    height: 0;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.1);
    transform: translate(-50%, -50%);
    transition: width 0.6s, height 0.6s;
}

.btn:hover::before {
    width: 300px;
    height: 300px;
}

.btn-primary {
    background: var(--gradient-primary);
    color: white;
    box-shadow: var(--shadow-md);
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
}

.btn-secondary {
    background: white;
    color: var(--gray-700);
    border: 2px solid var(--gray-300);
}

.btn-secondary:hover {
    border-color: var(--primary);
    color: var(--primary);
    transform: translateY(-2px);
}

.btn-success {
    background: var(--gradient-secondary);
    color: white;
    box-shadow: var(--shadow-md);
}

.btn-success:hover {
    transform: translateY(-2px);
    box-shadow: var(--shadow-lg);
}

/* ===== OUTPUT PANEL ===== */
.output-panel {
    background: white;
    border-radius: var(--radius-xl);
    padding: var(--space-2xl);
    box-shadow: var(--shadow-lg);
    border: 1px solid var(--gray-200);
}

.output-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-xl);
}

.output-title {
    font-size: 1.25rem;
}

.output-content {
    background: var(--gray-900);
    color: var(--gray-100);
    border-radius: var(--radius);
    padding: var(--space-xl);
    font-family: var(--font-mono);
    font-size: 0.875rem;
    line-height: 1.7;
    overflow-x: auto;
    min-height: 300px;
}

/* ===== STATUS BADGES ===== */
.status-badge {
    display: inline-flex;
    align-items: center;
    gap: var(--space-xs);
    padding: var(--space-xs) var(--space-md);
    border-radius: 9999px;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.badge-success {
    background: rgba(16, 185, 129, 0.1);
    color: var(--success);
    border: 1px solid rgba(16, 185, 129, 0.2);
}

.badge-warning {
    background: rgba(245, 158, 11, 0.1);
    color: var(--warning);
    border: 1px solid rgba(245, 158, 11, 0.2);
}

.badge-error {
    background: rgba(220, 38, 38, 0.1);
    color: var(--danger);
    border: 1px solid rgba(220, 38, 38, 0.2);
}

/* ===== RESPONSIVE DESIGN ===== */
@media (max-width: 1200px) {
    .app-container {
        grid-template-columns: 1fr;
    }
    
    .sidebar {
        display: none;
    }
    
    .stats-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (max-width: 768px) {
    .main-content {
        padding: var(--space-lg);
    }
    
    .stats-grid {
        grid-template-columns: 1fr;
    }
    
    .form-grid {
        grid-template-columns: 1fr;
    }
    
    .action-buttons {
        flex-direction: column;
    }
    
    .header {
        flex-direction: column;
        gap: var(--space-lg);
        text-align: center;
    }
}

/* ===== ANIMATIONS ===== */
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

@keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
}

@keyframes slideIn {
    from { transform: translateX(-100%); }
    to { transform: translateX(0); }
}

.animate-fade {
    animation: fadeIn 0.6s ease-out;
}

.animate-pulse {
    animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

.animate-slide {
    animation: slideIn 0.3s ease-out;
}

/* ===== UTILITIES ===== */
.text-gradient {
    background: var(--gradient-primary);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

.shadow-glow {
    box-shadow: 0 0 20px rgba(124, 58, 237, 0.3);
}

.glass-effect {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.hidden {
    display: none !important;
}

.w-full {
    width: 100%;
}

.h-full {
    height: 100%;
}

.flex {
    display: flex;
}

.items-center {
    align-items: center;
}

.justify-between {
    justify-content: space-between;
}

.gap-2 {
    gap: var(--space-sm);
}

.gap-4 {
    gap: var(--space-lg);
}

.mb-4 {
    margin-bottom: var(--space-lg);
}

.mt-4 {
    margin-top: var(--space-lg);
}

.p-4 {
    padding: var(--space-lg);
}

.rounded-lg {
    border-radius: var(--radius-lg);
}

.border {
    border: 1px solid var(--gray-200);
}
</style>
</head>
<body>
    <div class="container">
        <h1>‚ö° XML EDITOR - GERADOR AUTOM√ÅTICO CT-e/MDF-e ‚ö°</h1>
        
        <div class="status">
            ‚úÖ SISTEMA PRONTO - XMLs BASE CARREGADOS NA MEM√ìRIA
        </div>
        
        <div class="form-grid">
            <div class="input-group">
                <label>üî¢ NOVO N√öMERO CT-e:</label>
                <input type="number" id="numeroCte" placeholder="091732" value="91732" min="1" step="1">
            </div>
            
            <div class="input-group">
                <label>üîë CHAVE CT-e GERADA:</label>
                <input type="text" id="chaveCte" readonly style="background: #222;">
                <small id="statusCte">Clique em "Gerar Chaves"</small>
            </div>
            
            <div class="input-group">
                <label>üî¢ NOVO N√öMERO MDF-e:</label>
                <input type="number" id="numeroMdfe" placeholder="091732" value="91732" min="1" step="1">
            </div>
            
            <div class="input-group">
                <label>üîë CHAVE MDF-e GERADA:</label>
                <input type="text" id="chaveMdfe" readonly style="background: #222;">
                <small id="statusMdfe">Clique em "Gerar Chaves"</small>
            </div>
        </div>
        
        <div class="input-group">
            <label>üìÖ DATA EMISS√ÉO (YYYY-MM-DDTHH:MM:SS-03:00):</label>
            <input type="text" id="dataEmissao" value="2025-09-27T10:00:00-03:00">
        </div>
        
        <div class="buttons">
            <button onclick="gerarChaves()">üîë GERAR CHAVES AUTOMATICAMENTE</button>
            <button onclick="gerarXMLs()">‚ö° GERAR NOVOS XMLs</button>
            <button onclick="baixarTudo()">üíæ BAIXAR TUDO (ZIP)</button>
            <button onclick="autoProximaViagem()">üîÑ PR√ìXIMA VIAGEM</button>
        </div>
        
        <div class="output" id="output">
            <!-- Resultados aparecem aqui -->
        </div>
        
        <div class="download-links" id="downloadLinks">
            <a href="#" class="download-link" id="linkCte">‚¨áÔ∏è BAIXAR CT-e</a>
            <a href="#" class="download-link" id="linkMdfe">‚¨áÔ∏è BAIXAR MDF-e</a>
            <a href="#" class="download-link" id="linkZip">üì¶ BAIXAR ZIP</a>
        </div>
    </div>

    <script>
        // ============================================
        // DADOS FIXOS DA SUA EMPRESA (DOS SEUS XMLs)
        // ============================================
        const DADOS_EMPRESA = {
            cUF: '41',                    // PR - Paran√°
            CNPJ: '11158565000118',       // Seu CNPJ
            modelo: '57',                 // CT-e
            serie: '1',                   // S√©rie
            tpEmis: '1',                  // Normal
            cDV: '7',                     // DV da chave original
            
            // Para MDF-e
            modeloMDFe: '58',             // MDF-e
            serieMDFe: '22',              // S√©rie MDF-e
            tpAmb: '1',                   // Produ√ß√£o
            cMDF: '02328384'              // C√≥digo MDF-e
        };

        // ============================================
        // XMLs BASE FIXOS NA MEM√ìRIA
        // ============================================
        const CTE_BASE = `<?xml version="1.0" encoding="UTF-8"?>
<cteProc versao="3.00" xmlns="http://www.portalfiscal.inf.br/cte">
	<CTe xmlns="http://www.portalfiscal.inf.br/cte">
		<infCte Id="CTe41250611158565000118570010000917261001054737" versao="3.00">
			<ide>
				<cUF>41</cUF>
				<cCT>00105473</cCT>
				<CFOP>6352</CFOP>
				<natOp>PRESTACAO  SERVICOS DE  TRANSPORTES</natOp>
				<mod>57</mod>
				<serie>1</serie>
				<nCT>091731</nCT>
				<dhEmi>2025-09-26T12:43:00-03:00</dhEmi>
				<tpImp>1</tpImp>
				<tpEmis>1</tpEmis>
				<cDV>7</cDV>
				<tpAmb>1</tpAmb>
				<tpCTe>0</tpCTe>
				<procEmi>0</procEmi>
				<verProc>NDDigital CTe 4.8.5</verProc>
				<cMunEnv>4125506</cMunEnv>
				<xMunEnv>SAO JOSE DOS PINHAIS</xMunEnv>
				<UFEnv>PR</UFEnv>
				<modal>01</modal>
				<tpServ>0</tpServ>
				<cMunIni>4125506</cMunIni>
				<xMunIni>SAO JOSE DOS PINHAIS</xMunIni>
				<UFIni>PR</UFIni>
				<cMunFim>3554102</cMunFim>
				<xMunFim>TAUBATE</xMunFim>
				<UFFim>SP</UFFim>
				<retira>1</retira>
				<indIEToma>1</indIEToma>
				<toma3>
					<toma>0</toma>
				</toma3>
			</ide>
			<compl>
				<xCaracAd>Teste CadTnp</xCaracAd>
				<xCaracSer>Teste CadSer</xCaracSer>
				<xEmi>Teste FunEmi</xEmi>
				<fluxo>
					<pass>
						<xPass>Teste SigPas</xPass>
					</pass>
				</fluxo>
				<Entrega>
					<semData>
						<tpPer>0</tpPer>
					</semData>
					<semHora>
						<tpHor>0</tpHor>
					</semHora>
				</Entrega>
				<xObs>DEVOLUCAO DE PECAS/EMBALAGENS -  / DATA VENCIMENTO: 10/01/2024 / PLACA:AUU0D40 - RENAVAM:899048080 / PLACA REBOQUE:AKM8I69 - RENAVAM:00791445631 / PLACA REBOQUE (2):DJE9039 - RENAVAM:00791445631 / MOTORISTA:PAULO MONTEIRO WATERKEMPER - CPF:65446410220 / CARTAO PEDAGIO:0000000000000000 ID:14771862365 VALOR:647,88 / CVA:892451 - TIPO DE VIAGEM: FTL-BITREM -  / SEGURADORA: 4-RSA SEGUROS / APOLICE: 5400028799 / REQUISICAO: PEDIDO:7600024486 / CIOT:024035059815 /</xObs>
				<ObsCont xCampo="Obs Cmp Teste">
					<xTexto>.</xTexto>
				</ObsCont>
			</compl>
			<emit>
				<CNPJ>11158565000118</CNPJ>
				<IE>9032205116</IE>
				<xNome>Pr√© vendas transportadora</xNome>
				<xFant>SAO JOSE PINHAIS - PR</xFant>
				<enderEmit>
					<xLgr>RUA ANTONIO SINGER</xLgr>
					<nro>6.751</nro>
					<xBairro>CAMPO LARGO ROSEIRA</xBairro>
					<cMun>4125506</cMun>
					<xMun>SAO JOSE DOS PINHAIS</xMun>
					<CEP>83090901</CEP>
					<UF>PR</UF>
					<fone>00004133843470</fone>
				</enderEmit>
				<CRT>3</CRT>
			</emit>
			<rem>
				<CNPJ>59104422010384</CNPJ>
				<IE>9013276371</IE>
				<xNome>NDD TESTE MOVE</xNome>
				<xFant>NDD TESTE MOVE</xFant>
				<fone>00004133813568</fone>
				<enderReme>
					<xLgr>RUA ANTONIO SINGER</xLgr>
					<nro>6751</nro>
					<xBairro>CAMPO LARGO ROSEIRA</xBairro>
					<cMun>4125506</cMun>
					<xMun>SAO JOSE DOS PINHAIS</xMun>
					<CEP>83090901</CEP>
					<UF>PR</UF>
					<cPais>1058</cPais>
					<xPais>Brasil</xPais>
				</enderReme>
				<email>william.souza@ndd.tech</email>
			</rem>
			<exped>
				<CNPJ>59104422010384</CNPJ>
				<IE>9013276371</IE>
				<xNome>NDD TESTE MOVE</xNome>
				<fone>00004133813568</fone>
				<enderExped>
					<xLgr>RUA ANTONIO SINGER</xLgr>
					<nro>6751</nro>
					<xBairro>CAMPO LARGO ROSEIRA</xBairro>
					<cMun>4125506</cMun>
					<xMun>SAO JOSE DOS PINHAIS</xMun>
					<CEP>83090901</CEP>
					<UF>PR</UF>
					<cPais>1058</cPais>
					<xPais>Brasil</xPais>
				</enderExped>
				<email>joao.pinheiro@ndd.tech</email>
			</exped>
			<receb>
				<CNPJ>02147467000518</CNPJ>
				<IE>688165993113</IE>
				<xNome>NDD TESTE MOVE</xNome>
				<fone>00001236276408</fone>
				<enderReceb>
					<xLgr>R. Heitor Villa Lobos</xLgr>
					<nro>525</nro>
					<xBairro>S√£o Francisco</xBairro>
					<cMun>4208702</cMun>
					<xMun>LAGES</xMun>
					<CEP>88506400</CEP>
					<UF>SC</UF>
					<cPais>1058</cPais>
					<xPais>Brasil</xPais>
				</enderReceb>
				<email>gpa-nfe@br.gestamp.com</email>
			</receb>
			<dest>
				<CNPJ>71363101000175</CNPJ>
				<IE>688165993113</IE>
				<xNome>NDD TESTE MOVE</xNome>
				<fone>00001236276408</fone>
				<enderDest>
					<xLgr>R. Heitor Villa Lobos</xLgr>
					<nro>525</nro>
					<xBairro>S√£o Francisco</xBairro>
					<cMun>4208702</cMun>
					<xMun>LAGES</xMun>
					<CEP>88506400</CEP>
					<UF>SP</UF>
					<cPais>1058</cPais>
					<xPais>Brasil</xPais>
				</enderDest>
				<email>joao.pinheiro@ndd.tech</email>
			</dest>
			<vPrest>
				<vTPrest>1254.66</vTPrest>
				<vRec>1254.66</vRec>
				<Comp>
					<xNome>Frete/Unitario</xNome>
					<vComp>1254.66</vComp>
				</Comp>
				<Comp>
					<xNome>Frete/Peso</xNome>
					<vComp>1254.66</vComp>
				</Comp>
				<Comp>
					<xNome>Frete/Valor</xNome>
					<vComp>0.00</vComp>
				</Comp>
				<Comp>
					<xNome>Outros/Transbor</xNome>
					<vComp>0.00</vComp>
				</Comp>
				<Comp>
					<xNome>SEC-CAT</xNome>
					<vComp>0.00</vComp>
				</Comp>
				<Comp>
					<xNome>Pedagio</xNome>
					<vComp>0.00</vComp>
				</Comp>
				<Comp>
					<xNome>Despacho</xNome>
					<vComp>0.00</vComp>
				</Comp>
				<Comp>
					<xNome>Peso Total</xNome>
					<vComp>1000.00</vComp>
				</Comp>
			</vPrest>
			<imp>
				<ICMS>
					<ICMS00>
						<CST>00</CST>
						<vBC>1254.66</vBC>
						<pICMS>12.00</pICMS>
						<vICMS>150.56</vICMS>
					</ICMS00>
				</ICMS>
				<vTotTrib>150.56</vTotTrib>
			</imp>
			<infCTeNorm>
				<infCarga>
					<vCarga>87736.68</vCarga>
					<proPred>UNIDADE</proPred>
					<infQ>
						<cUnid>01</cUnid>
						<tpMed>PESO</tpMed>
						<qCarga>1000</qCarga>
					</infQ>
				</infCarga>
				<infDoc>
					<infNFe>
						<chave>41231159104422010384550380004425511317946100</chave>
					</infNFe>
				</infDoc>
				<infModal versaoModal="3.00">
					<rodo>
						<RNTRC>00109548</RNTRC>
					</rodo>
				</infModal>
				<cobr>
					<dup>
						<nDup>105458G 1</nDup>
						<dVenc>2024-01-10</dVenc>
						<vDup>1254.66</vDup>
					</dup>
				</cobr>
			</infCTeNorm>
		</infCte>
		<infCTeSupl>
			<qrCodCTe>http://www.fazenda.pr.gov.br/cte/qrcode?chCTe=41231111158565000118570010001054581001054737&amp;tpAmb=1</qrCodCTe>
		</infCTeSupl>
		<Signature xmlns="http://www.w3.org/2000/09/xmldsig#">
			<SignedInfo>
				<CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
				<SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
				<Reference URI="#CTe41231111158565000118570010001054581001054737">
					<Transforms>
						<Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
						<Transform Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
					</Transforms>
					<DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
					<DigestValue>h0V9xLqpcwaRlwTSiJ1ai8/n7vI=</DigestValue>
				</Reference>
			</SignedInfo>
			<SignatureValue>Hev/TYisXsJpawWwvHid5L2+3TYZhOVJul53ilQXO79FpP89FscWa8jPPN5KaN0aQ5Y/C981wpjfY+Hr6PqmScSDMG2PHQ0ufxZNAvGZbJ3fb0YaMIceKU4WP8vHmkUUFyidRyDdmZTRLZruhy0L49kDFuG3Ap3or9aFOD/DqSXBTa+rA9ActBrXmuEJEEYU1Bs5fjNkyvA5ZwtSyRfPyqn0HGDcHHo1IzEi/zna/YUWCJwH3GWv9p6SqmPnkDklm5pf82lNEAmqFJPVZo2aeYDX4zr8nyhpdK6ZyGS8Hmfe62Up6wPxQxQxj/M5krqXwwinT1t0/MSGNuVteiWEFQ==</SignatureValue>
			<KeyInfo>
				<X509Data>
					<X509Certificate>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</X509Certificate>
				</X509Data>
			</KeyInfo>
		</Signature>
	</CTe>
	<protCTe versao="3.00">
		<infProt>
			<tpAmb>1</tpAmb>
			<verAplic>PR-v3_3_11</verAplic>
			<chCTe>41250611158565000118570010000917311001054737</chCTe>
			<dhRecbto>2025-09-26T12:44:54-03:00</dhRecbto>
			<nProt>141230252735166</nProt>
			<digVal>h0V9xLqpcwaRlwTSiJ1ai8/n7vI=</digVal>
			<cStat>100</cStat>
			<xMotivo>Autorizado o uso do CT-e</xMotivo>
		</infProt>
	</protCTe>
</cteProc>`;

        const MDFE_BASE = `<?xml version="1.0" encoding="UTF-8"?>
<mdfeProc versao="3.00" xmlns="http://www.portalfiscal.inf.br/mdfe">
	<MDFe xmlns="http://www.portalfiscal.inf.br/mdfe">
		<infMDFe Id="MDFe41250611158565000118580010000091728023283840" versao="3.00">
			<ide>
				<cUF>41</cUF>
				<tpAmb>1</tpAmb>
				<tpEmit>1</tpEmit>
				<mod>58</mod>
				<serie>22</serie>
				<nMDF>091731</nMDF>
				<cMDF>02328384</cMDF>
				<cDV>0</cDV>
				<modal>1</modal>
				<dhEmi>2025-09-26T13:10:00-03:00</dhEmi>
				<tpEmis>1</tpEmis>
				<procEmi>0</procEmi>
				<verProc>NDDigital MDFe 4.8.5</verProc>
				<UFIni>PR</UFIni>
				<UFFim>SP</UFFim>
				<infMunCarrega>
					<cMunCarrega>4125506</cMunCarrega>
					<xMunCarrega>SAO JOSE DOS PINHAIS</xMunCarrega>
				</infMunCarrega>
				<dhIniViagem>2025-06-17T13:10:00-03:00</dhIniViagem>
			</ide>
			<emit>
				<CNPJ>11158565000118</CNPJ>
				<IE>9032205116</IE>
				<xNome>Pr√© vendas transportadora</xNome>
				<xFant>SAO JOSE PINHAIS - PR</xFant>
				<enderEmit>
					<xLgr>RUA ANTONIO SINGER</xLgr>
					<nro>6.751</nro>
					<xBairro>CAMPO LARGO ROSEIRA</xBairro>
					<cMun>4125506</cMun>
					<xMun>SAO JOSE DOS PINHAIS</xMun>
					<CEP>83090901</CEP>
					<UF>PR</UF>
					<fone>49984094010</fone>
				</enderEmit>
			</emit>
			<infModal versaoModal="3.00">
				<rodo>
					<infANTT>
						<RNTRC>00109548</RNTRC>
						<valePed>
							<disp>
								<CNPJForn>04088208000165</CNPJForn>
								<CNPJPg>59104422010384</CNPJPg>
								<nCompra>14771862365</nCompra>
								<vValePed>647.88</vValePed>
								<tpValePed>01</tpValePed>
							</disp>
							<categCombVeic>08</categCombVeic>
						</valePed>
						<infContratante>
							<xNome>NDD TESTE MOVE</xNome>
							<CNPJ>59104422010384</CNPJ>
						</infContratante>
					</infANTT>
					<veicTracao>
						<placa>AUU0D40</placa>
						<RENAVAM>899048080</RENAVAM>
						<tara>0</tara>
						<capKG>0</capKG>
						<capM3>0</capM3>
						<condutor>
							<xNome>JO√ÉO VICTOR NUNES PINHEIRO</xNome>
							<CPF>01193932980</CPF>
						</condutor>
						<tpRod>06</tpRod>
						<tpCar>01</tpCar>
						<UF>PR</UF>
					</veicTracao>
				</rodo>
			</infModal>
			<infDoc>
				<infMunDescarga>
					<cMunDescarga>3554102</cMunDescarga>
					<xMunDescarga>TAUBATE</xMunDescarga>
					<infCTe>
						<chCTe>41250611158565000118570010000917311001054737</chCTe>
					</infCTe>
				</infMunDescarga>
			</infDoc>
			<seg>
				<infResp>
					<respSeg>2</respSeg>
					<CNPJ>59104422000150</CNPJ>
				</infResp>
				<infSeg>
					<xSeg>SOMPO SEGUROS</xSeg>
					<CNPJ>60405925000144</CNPJ>
				</infSeg>
				<nApol>5400026836</nApol>
				<nAver>KJP55152AO4SDTAX185B0ANV84RVRQZTR</nAver>
			</seg>
			<prodPred>
				<tpCarga>05</tpCarga>
				<xProd>B.ZINCADA</xProd>
				<cEAN>SEM GTIN</cEAN>
				<NCM>72104910</NCM>
				<infLotacao>
					<infLocalCarrega>
						<CEP>83000000</CEP>
					</infLocalCarrega>
					<infLocalDescarrega>
						<CEP>12072010</CEP>
					</infLocalDescarrega>
				</infLotacao>
			</prodPred>
			<tot>
				<qCTe>1</qCTe>
				<vCarga>87736.68</vCarga>
				<cUnid>01</cUnid>
				<qCarga>1000.0000</qCarga>
			</tot>
		</infMDFe>
		<infMDFeSupl>
			<qrCodMDFe>https://dfe-portal.svrs.rs.gov.br/mdfe/qrCode?chMDFe=41231111158565000118580010000104701023283840&amp;tpAmb=1</qrCodMDFe>
		</infMDFeSupl>
		<Signature xmlns="http://www.w3.org/2000/09/xmldsig#">
			<SignedInfo>
				<CanonicalizationMethod Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
				<SignatureMethod Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/>
				<Reference URI="#MDFe41231111158565000118580010000104701023283840">
					<Transforms>
						<Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
						<Transform Algorithm="http://www.w3.org/TR/2001/REC-xml-c14n-20010315"/>
					</Transforms>
					<DigestMethod Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/>
					<DigestValue>Ik0DC6lkhsj+Z7SMl94tEJtw/rM=</DigestValue>
				</Reference>
			</SignedInfo>
			<SignatureValue>ob2TxaF8xgjNFQvyRLq09Z8Vqgbb57JGMSV2wd33JbGMOxRNgONxa3NarsPHZ1Nz5GkEjP/iH3MDnj4vjKL54LajvxP1k6m2uyS8t88qfBC/T0/BSd9M2/zP6+0OjOqW55+scM1zTAJ4mYsGq/NSG54veHy66gXx12VTXXJKT17brv5KDUgvhRlKp+OllSTBy8HDkJC0dXziLykEZunhaHJFrzSW0j7F6D1pc6hsooMHkztLNBCppTtJz0VADxCudQhfcIn/J0jRMFUDk0ZrQnWaQ5p5OulXlakV2i2QEw4Pd7bgtK7I56g0J18sZp3w8Yz+UFs8RIB0f7Oeb5PV2w==</SignatureValue>
			<KeyInfo>
				<X509Data>
					<X509Certificate>MIIICjCCBfKgAwIBAgIQFuv/M7+A5PApmcyQXwN0/jANBgkqhkiG9w0BAQsFADB4MQswCQYDVQQGEwJCUjETMBEGA1UEChMKSUNQLUJyYXNpbDE2MDQGA1UECxMtU2VjcmV0YXJpYSBkYSBSZWNlaXRhIEZlZGVyYWwgZG8gQnJhc2lsIC0gUkZCMRwwGgYDVQQDExNBQyBDZXJ0aXNpZ24gUkZCIEc1MB4XDTIzMTAyNjE1MTM0OFoXDTI0MTAyNTE1MTM0OFowgfoxCzAJBgNVBAYTAkJSMRMwEQYDVQQKDApJQ1AtQnJhc2lsMQswCQYDVQQIDAJTUDESMBAGA1UEBwwJU2FvIFBhdWxvMRkwFwYDVQQLDBBWaWRlb0NvbmZlcmVuY2lhMRcwFQYDVQQLDA4zNDczMjg1NDAwMDE4NDE2MDQGA1UECwwtU2VjcmV0YXJpYSBkYSBSZWNlaXRhIEZlZGVyYWwgZG8gQnJhc2lsIC0gUkZCMRYwFAYDVQQLDA1SRkIgZS1DTlBKIEExMTEwLwYDVQQDDChUUkFOU05PVkFHIFRSQU5TUE9SVEVTIFNBOjU1ODkwMDE2MDAwMTA5MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA0q5LF5lwrjQqD3XwkrKbrKO95dsjDdSK0RSxutZhXXA/8N7gktgR4jk3lLCN2d17lJtmNW4VUR1KezTGjJQAjKk9wx1HNGQZpv06yAi9CHXjblWH5fNT3B/TKO8vpiVJU/sVC2RrfGvBDDitD7Wbx0kMtNHl6zzL4vwzKn/f8pmFCl29SMuJ8xNrQYqYvf84d7ICCCiNbgCeip084uJCdrSqV7ZcUOM00tsjsqhXmAWvq4TA1mKn1TGOU9r7O91c7X5cBCDALfHOGQNqtkbQmvr2bGsxKVo2mwsgELe0aR/umxWllQLfQJInrsgFMTdQpv0liuy5CdlU8wvdOcftFwIDAQABo4IDCzCCAwcwgboGA1UdEQSBsjCBr6A9BgVgTAEDBKA0BDIyNTAyMTk1OTk0MDExNzUzODE1MDAwMDAwMDAwMDAwMDAwMDAwMDcyNTk0OTNTU1BTUKAfBgVgTAEDAqAWBBRKT0FPIExVQ0lBTk8gR1JBTkFET6AZBgVgTAEDA6AQBA41NTg5MDAxNjAwMDEwOaAXBgVgTAEDB6AOBAwwMDAwMDAwMDAwMDCBGVNJU1RFTUFTQEZFUlJPTEVORS5DT00uQlIwCQYDVR0TBAIwADAfBgNVHSMEGDAWgBRTfX+dvtFh0CC62p/jiacTc1jNQjB/BgNVHSAEeDB2MHQGBmBMAQIBDDBqMGgGCCsGAQUFBwIBFlxodHRwOi8vaWNwLWJyYXNpbC5jZXJ0aXNpZ24uY29tLmJyL3JlcG9zaXRvcmlvL2RwYy9BQ19DZXJ0aXNpZ25fUkZCL0RQQ19BQ19DZXJ0aXNpZ25fUkZCLnBkZjCBvAYDVR0fBIG0MIGxMFegVaBThlFodHRwOi8vaWNwLWJyYXNpbC5jZXJ0aXNpZ24uY29tLmJyL3JlcG9zaXRvcmlvL2xjci9BQ0NlcnRpc2lnblJGQkc1L0xhdGVzdENSTC5jcmwwVqBUoFKGUGh0dHA6Ly9pY3AtYnJhc2lsLm91dHJhbGNyLmNvbS5ici9yZXBvc2l0b3Jpby9sY3IvQUNDZXJ0aXNpZ25SRkJHNS9MYXRlc3RDUkwuY3JsMA4GA1UdDwEB/wQEAwIF4DAdBgNVHSUEFjAUBggrBgEFBQcDAgYIKwYBBQUHAwQwgawGCCsGAQUFBwEBBIGfMIGcMF8GCCsGAQUFBzAChlNodHRwOi8vaWNwLWJyYXNpbC5jZXJ0aXNpZ24ucom.brMA0GCSqGSIb3DQEBCsUAA4ICAQBVn+njpIoyz9To/8GqlGgKrm4JMXqhOKcNoBpnf9mGldqfz2xLeL6cj5kn8/jTe7sTTpCAvs2y8w/MzsTBs5KiBR7OrXis97XP1yWbx/3gew/zmDj0EeuTfPU+n7cehqy0zzWUpRdgEa5GSuQn44KUlE/scNriWhk4iWYKdZVwzTuJweotqHv3OYTZmxpYjNOhIJos8WxWCvwGqMwdkIdunTPnxyRdjAXVuryqe9BblDVkee/ByyFg9d0x9ehHudCf78BqAGj/5xpZnmE/xFNnjmDu6Kbq+ZKGVGgzAdekvkVnZeUq3JWztzugGzfbqVPDnspnRS5SHiRcnsftXVzR3RrpHFKAjzT+4ErNOnyDrysimsh1+ZOEyS2fN63z0EkNkEcOrt2AlwmFFnBhwEyg+OTAH3UdJpcvI9678bFNOvcpgOWPBPkFeG3cLN9dimgV60eB6kGQYr7KZusmonZwwZZxeGXryBYe25QVWOJhpn0YU8LW8MMcwPMfLD7o23R9iUEXt8ODpedDIwwLHaKp1gZDc9Idy32Qux6svAzMWoSEap2Gsh+dtnkbaIh81zc1tBGGBAb7cd/89KBGtJCy/pNavVrcOM1FrTYbj9UHOAc0sUQz3zHSEFun/qNcF3GP377RsEzMEfBXBcpOQsgeLFApYl9uqqXSbprwn1Mlgg==</X509Certificate>
				</X509Data>
			</KeyInfo>
		</Signature>
	</MDFe>
	<protMDFe versao="3.00">
		<infProt Id="MDFe941230017668937">
			<tpAmb>1</tpAmb>
			<verAplic>RS20230403093610</verAplic>
			<chMDFe>41250611158565000118580010000091731023283840</chMDFe>
			<dhRecbto>2025-26-09T13:17:17-03:00</dhRecbto>
			<nProt>941230017668937</nProt>
			<digVal>Ik0DC6lkhsj+Z7SMl94tEJtw/rM=</digVal>
			<cStat>100</cStat>
			<xMotivo>Autorizado o uso do MDF-e</xMotivo>
		</infProt>
	</protMDFe>
</mdfeProc>`;

        // ============================================
// FUN√á√ïES PARA GERAR CHAVES DE ACESSO - CORRIGIDO!
// ============================================

function gerarChaveCTe(numeroCTe) {
    // CORRE√á√ÉO: O n√∫mero do CT-e (nCT) DEVE estar na chave!
    // Posi√ß√µes 26-34 (9 d√≠gitos) s√£o para o nCT
    
    const nCT = numeroCTe.toString().padStart(9, '0'); // 9 d√≠gitos, zeros √† esquerda
    const serie = DADOS_EMPRESA.serie.padStart(3, '0'); // 3 d√≠gitos
    const cCT = '00105473'; // C√≥digo num√©rico FIXO do seu XML original
    
    // ESTRUTURA DA CHAVE CT-e (44 d√≠gitos):
    // 1-2: cUF = 41 (PR)
    // 3-6: AAMM = Ano e m√™s (ex: 2509)
    // 7-20: CNPJ = 11158565000118
    // 21-22: mod = 57 (CT-e)
    // 23-25: serie = 001
    // 26-34: nCT = 000091732 (9 d√≠gitos do n√∫mero do CT-e!) ‚Üê AQUI EST√Å O N√öMERO!
    // 35: tpEmis = 1
    // 36-43: cCT = 00105473
    // 44: DV = d√≠gito verificador
    
    const AAMM = getAAMM();
    
    // Montar chave de 43 d√≠gitos (sem o DV)
    const chave43 = 
        DADOS_EMPRESA.cUF +      // 2 d√≠gitos
        AAMM +                   // 4 d√≠gitos
        DADOS_EMPRESA.CNPJ +     // 14 d√≠gitos
        DADOS_EMPRESA.modelo +   // 2 d√≠gitos (57)
        serie +                  // 3 d√≠gitos (001)
        nCT +                    // 9 d√≠gitos (n√∫mero do CT-e!) ‚Üê CORRIGIDO!
        DADOS_EMPRESA.tpEmis +   // 1 d√≠gito
        cCT;                     // 8 d√≠gitos
                                 // Total: 43 d√≠gitos
    
    // Calcular DV
    const dv = calcularDigitoVerificador(chave43);
    
    return chave43 + dv; // 44 d√≠gitos
}

function gerarChaveMDFe(numeroMDFe) {
    // J√Å ESTAVA CORRETO: O n√∫mero do MDF-e est√° na chave
    const nMDF = numeroMDFe.toString().padStart(9, '0'); // 9 d√≠gitos
    const serie = DADOS_EMPRESA.serieMDFe.padStart(3, '0'); // 3 d√≠gitos
    const cMDF = DADOS_EMPRESA.cMDF; // C√≥digo MDF-e fixo
    
    const AAMM = getAAMM();
    
    // Montar chave de 43 d√≠gitos (sem o DV)
    const chave43 = 
        DADOS_EMPRESA.cUF +          // 2
        AAMM +                       // 4
        DADOS_EMPRESA.CNPJ +         // 14
        DADOS_EMPRESA.modeloMDFe +   // 2 (58)
        serie +                      // 3
        nMDF +                       // 9 (n√∫mero do MDF-e) ‚Üê J√Å ESTAVA CORRETO!
        DADOS_EMPRESA.tpEmis +       // 1
        cMDF;                        // 8
                                     // Total: 43
    
    const dv = calcularDigitoVerificador(chave43);
    
    return chave43 + dv; // 44 d√≠gitos
}

function getAAMM() {
    const now = new Date();
    const year = now.getFullYear().toString().slice(2); // √∫ltimos 2 d√≠gitos do ano
    const month = (now.getMonth() + 1).toString().padStart(2, '0');
    return year + month;
}

function calcularDigitoVerificador(chave43) {
    let soma = 0;
    let peso = 2;
    
    for (let i = chave43.length - 1; i >= 0; i--) {
        soma += parseInt(chave43.charAt(i)) * peso;
        peso = (peso === 9) ? 2 : peso + 1;
    }
    
    const resto = soma % 11;
    const dv = (11 - resto);
    
    if (dv === 0 || dv === 1 || dv > 9) {
        return '0';
    }
    
    return dv.toString();
}
        
        function gerarNumeroAleatorio(tamanho) {
            let numero = '';
            for (let i = 0; i < tamanho; i++) {
                numero += Math.floor(Math.random() * 10);
            }
            return numero;
        }
        
        // ============================================
        // FUN√á√ïES PRINCIPAIS DA INTERFACE
        // ============================================
        
        let cteGerado = null;
        let mdfeGerado = null;
        let ultimoNumeroCTe = 91731;
        let ultimoNumeroMDFe = 91731;
        
        function gerarChaves() {
            const numeroCte = parseInt(document.getElementById('numeroCte').value) || ultimoNumeroCTe + 1;
            const numeroMdfe = parseInt(document.getElementById('numeroMdfe').value) || ultimoNumeroMDFe + 1;
            
            // Atualizar n√∫meros se n√£o foram preenchidos
            document.getElementById('numeroCte').value = numeroCte;
            document.getElementById('numeroMdfe').value = numeroMdfe;
            
            // Gerar chaves
            const chaveCte = gerarChaveCTe(numeroCte);
            const chaveMdfe = gerarChaveMDFe(numeroMdfe);
            
            // Atualizar campos
            document.getElementById('chaveCte').value = chaveCte;
            document.getElementById('chaveMdfe').value = chaveMdfe;
            
            document.getElementById('statusCte').textContent = `‚úÖ Chave v√°lida (44 d√≠gitos)`;
            document.getElementById('statusMdfe').textContent = `‚úÖ Chave v√°lida (44 d√≠gitos)`;
            
            document.getElementById('output').innerHTML = `
                <div style="color: #00ff00; font-weight: bold;">
                    üîë CHAVES GERADAS AUTOMATICAMENTE!
                </div>
                <div style="margin-top: 15px;">
                    <strong>CT-e ${numeroCte}:</strong> ${chaveCte}<br>
                    <strong>MDF-e ${numeroMdfe}:</strong> ${chaveMdfe}
                </div>
            `;
            
            // Atualizar √∫ltimos n√∫meros
            ultimoNumeroCTe = numeroCte;
            ultimoNumeroMDFe = numeroMdfe;
        }
        
        function gerarXMLs() {
            try {
                const numeroCte = document.getElementById('numeroCte').value;
                const chaveCte = document.getElementById('chaveCte').value;
                const numeroMdfe = document.getElementById('numeroMdfe').value;
                const chaveMdfe = document.getElementById('chaveMdfe').value;
                const dataEmissao = document.getElementById('dataEmissao').value;
                
                // Validar chaves
                if (!chaveCte || chaveCte.length !== 44) {
                    alert('Gere as chaves primeiro! Clique em "Gerar Chaves"');
                    return;
                }
                
                // ============================================
                // GERAR NOVO CT-e
                // ============================================
                cteGerado = CTE_BASE
                    .replace(/CTe\d{44}/g, `CTe${chaveCte}`)
                    .replace(/<nCT>\d+<\/nCT>/, `<nCT>${numeroCte.padStart(6, '0')}</nCT>`)
                    .replace(/<chCTe>\d+<\/chCTe>/, `<chCTe>${chaveCte}</chCTe>`)
                    .replace(/<dhEmi>[^<]+<\/dhEmi>/, `<dhEmi>${dataEmissao}</dhEmi>`)
                    .replace(/chCTe=\d+/g, `chCTe=${chaveCte}`)
                    .replace(/<nDup>[^<]+<\/nDup>/, `<nDup>${numeroCte}G 1</nDup>`)
                    .replace(/<dhRecbto>[^<]+<\/dhRecbto>/, `<dhRecbto>${dataEmissao}</dhRecbto>`);
                
                // ============================================
                // GERAR NOVO MDF-e
                // ============================================
                mdfeGerado = MDFE_BASE
                    .replace(/MDFe\d{44}/g, `MDFe${chaveMdfe}`)
                    .replace(/<nMDF>\d+<\/nMDF>/, `<nMDF>${numeroMdfe.padStart(6, '0')}</nMDF>`)
                    .replace(/<chMDFe>\d+<\/chMDFe>/, `<chMDFe>${chaveMdfe}</chMDFe>`)
                    .replace(/<chCTe>\d+<\/chCTe>/, `<chCTe>${chaveCte}</chCTe>`)
                    .replace(/<dhEmi>[^<]+<\/dhEmi>/, `<dhEmi>${dataEmissao}</dhEmi>`)
                    .replace(/<dhIniViagem>[^<]+<\/dhIniViagem>/, `<dhIniViagem>${dataEmissao}</dhIniViagem>`)
                    .replace(/chMDFe=\d+/g, `chMDFe=${chaveMdfe}`)
                    .replace(/<dhRecbto>[^<]+<\/dhRecbto>/, `<dhRecbto>${dataEmissao}</dhRecbto>`);
                
                // Mostrar resultados
                document.getElementById('output').innerHTML += `
                    <div style="color: #00ff00; margin-top: 20px; border-top: 1px solid #00ff00; padding-top: 20px;">
                        ‚úÖ XMLs GERADOS COM SUCESSO!
                    </div>
                    <div style="margin-top: 10px;">
                        <strong>CT-e:</strong> N√∫mero ${numeroCte} | Chave ${chaveCte}<br>
                        <strong>MDF-e:</strong> N√∫mero ${numeroMdfe} | Chave ${chaveMdfe}<br>
                        <strong>Data Emiss√£o:</strong> ${dataEmissao}
                    </div>
                `;
                
                // Mostrar links de download
                document.getElementById('downloadLinks').style.display = 'block';
                document.getElementById('linkCte').onclick = () => baixarCTe();
                document.getElementById('linkMdfe').onclick = () => baixarMDFe();
                document.getElementById('linkZip').onclick = () => baixarZIP();
                
            } catch (error) {
                document.getElementById('output').innerHTML = 
                    `<div style="color: #ff0000;">‚ùå ERRO: ${error.message}</div>`;
            }
        }
        
        function autoProximaViagem() {
            // Auto incrementar n√∫meros
            const novoNumeroCTe = ultimoNumeroCTe + 1;
            const novoNumeroMDFe = ultimoNumeroMDFe + 1;
            
            document.getElementById('numeroCte').value = novoNumeroCTe;
            document.getElementById('numeroMdfe').value = novoNumeroMDFe;
            
            // Gerar chaves automaticamente
            gerarChaves();
            
            // Gerar XMLs automaticamente
            setTimeout(() => {
                gerarXMLs();
                document.getElementById('output').innerHTML += 
                    `<div style="color: #00ff00; margin-top: 10px;">üîÑ PR√ìXIMA VIAGEM CONFIGURADA AUTOMATICAMENTE!</div>`;
            }, 500);
        }
        
        // Fun√ß√µes de download (mantidas iguais)
        function baixarCTe() {
            if (!cteGerado) return;
            const blob = new Blob([cteGerado], { type: 'application/xml' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `CTe_${document.getElementById('chaveCte').value}.xml`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        function baixarMDFe() {
            if (!mdfeGerado) return;
            const blob = new Blob([mdfeGerado], { type: 'application/xml' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `MDFe_${document.getElementById('chaveMdfe').value}.xml`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
        
        function baixarZIP() {
            if (!cteGerado || !mdfeGerado) return;
            
            if (window.JSZip) {
                const zip = new JSZip();
                zip.file(`CTe_${document.getElementById('chaveCte').value}.xml`, cteGerado);
                zip.file(`MDFe_${document.getElementById('chaveMdfe').value}.xml`, mdfeGerado);
                
                zip.generateAsync({ type: 'blob' }).then(function(content) {
                    const url = URL.createObjectURL(content);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `XMLs_${document.getElementById('chaveCte').value}.zip`;
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                });
            } else {
                baixarCTe();
                setTimeout(() => baixarMDFe(), 500);
            }
        }
        
        function baixarTudo() {
            if (!cteGerado || !mdfeGerado) {
                alert('Gere os XMLs primeiro!');
                return;
            }
            baixarZIP();
        }
        
        // Carregar JSZip dinamicamente
        if (!window.JSZip) {
            const script = document.createElement('script');
            script.src = 'https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js';
            document.head.appendChild(script);
        }
        
        // Gerar chaves iniciais ao carregar
        window.addEventListener('DOMContentLoaded', () => {
            gerarChaves();
        });
    </script>
</body>
</html>
